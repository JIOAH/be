<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìö Generator Daftar Pustaka - Fields Opsional</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(to right, #2c3e50, #4a6491);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }
        
        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .main-content {
            display: flex;
            flex-wrap: wrap;
            padding: 25px;
            gap: 25px;
        }
        
        .input-section {
            flex: 1;
            min-width: 350px;
            padding: 25px;
            background-color: #f9fafc;
            border-radius: 12px;
        }
        
        .output-section {
            flex: 1;
            min-width: 350px;
            padding: 25px;
            background-color: #f9fafc;
            border-radius: 12px;
        }
        
        .form-group {
            margin-bottom: 18px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
            font-size: 0.95rem;
        }
        
        .optional {
            color: #6c757d;
            font-weight: normal;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s;
            background: white;
        }
        
        .form-row {
            display: flex;
            gap: 15px;
        }
        
        .form-row .form-group {
            flex: 1;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #4a6491;
            box-shadow: 0 0 0 3px rgba(74, 100, 145, 0.15);
        }
        
        .btn {
            padding: 14px 25px;
            background: linear-gradient(135deg, #4a6491, #3a5479);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s;
            margin: 5px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(74, 100, 145, 0.25);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #6c757d, #5a6268);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #28a745, #218838);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #dc3545, #c82333);
        }
        
        /* STYLING UNTUK OUTPUT BOX - DIPERBARUI */
        .output-box {
            background-color: white;
            border: 2px solid #e1e5e9;
            border-radius: 12px;
            padding: 25px;
            min-height: 350px;
            max-height: 500px;
            overflow-y: auto;
            font-family: 'Times New Roman', serif;
            line-height: 1.8;
            white-space: pre-wrap;
            margin-top: 15px;
            font-size: 0.95rem;
        }
        
        /* Class untuk pemformatan paragraf */
        .formatted-output {
            line-height: 0.9 !important;
            font-family: 'Times New Roman', serif !important;
        }
        
        /* Indentasi gantung (hanging indent) */
        .hanging-indent {
            padding-left: 2em !important;
            text-indent: -2em !important;
        }
        
        /* Indentasi baris pertama */
        .first-line-indent {
            text-indent: 2em !important;
        }
        
        /* Tanpa indentasi */
        .no-indent {
            text-indent: 0 !important;
            padding-left: 0 !important;
        }
        
        /* Spasi antar referensi */
        .reference-spacing {
            margin-bottom: 1.2em !important;
        }
        
        .format-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 12px;
            margin-bottom: 25px;
        }
        
        .format-card {
            padding: 15px;
            background: white;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .format-card:hover {
            border-color: #4a6491;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .format-card.selected {
            background: #4a6491;
            color: white;
            border-color: #4a6491;
            box-shadow: 0 4px 12px rgba(74, 100, 145, 0.3);
        }
        
        .format-name {
            font-weight: 600;
            margin-bottom: 5px;
            font-size: 0.95rem;
        }
        
        .format-desc {
            font-size: 0.8rem;
            opacity: 0.8;
        }
        
        .action-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-top: 25px;
            justify-content: center;
        }
        
        .reference-item {
            background: white;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            border-left: 4px solid #4a6491;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            overflow-x: auto;
            padding-bottom: 10px;
        }
        
        .tab {
            padding: 10px 20px;
            background: #e9ecef;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            color: #495057;
            transition: all 0.3s;
            white-space: nowrap;
        }
        
        .tab.active {
            background: #4a6491;
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            
            .form-row {
                flex-direction: column;
                gap: 0;
            }
        }
        
        .field-info {
            font-size: 0.8rem;
            color: #666;
            margin-top: 5px;
            font-style: italic;
        }
        
        .required-star {
            color: #dc3545;
        }
        
        .optional-badge {
            display: inline-block;
            background: #6c757d;
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.7rem;
            margin-left: 5px;
        }
        
        .stats {
            display: flex;
            justify-content: space-between;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #4a6491;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #6c757d;
        }
        
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #333;
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }
        
        /* Panel kontrol pemformatan sederhana */
        .formatting-controls {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        
        .formatting-row {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: center;
        }
        
        .formatting-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .formatting-label {
            font-size: 0.85rem;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .formatting-select {
            padding: 8px 12px;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            font-size: 0.9rem;
        }
        
        .formatting-input {
            padding: 8px 12px;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            font-size: 0.9rem;
            width: 80px;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        /* Style untuk daftar pustaka tanpa nomor */
        .bibliography-item {
            margin-bottom: 0.9em !important;
            line-height: 0.9 !important;
        }
        
        .capitalize-author {
            text-transform: uppercase !important;
            font-weight: bold !important;
        }
        
        .normal-title {
            font-style: italic !important;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìö Generator Daftar Pustaka</h1>
            <p class="subtitle">Format Sederhana - Tanpa Penomoran</p>
        </header>
        
        <div class="main-content">
            <!-- INPUT SECTION -->
            <div class="input-section">
                <h2 style="color: #2c3e50; margin-bottom: 20px;">üìù Input Data Referensi</h2>
                
                <div class="stats">
                    <div class="stat-item">
                        <div class="stat-value" id="refCount">0</div>
                        <div class="stat-label">Referensi</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="completeCount">0</div>
                        <div class="stat-label">Lengkap</div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="refType">Jenis Referensi</label>
                    <select id="refType">
                        <option value="book">üìö Buku</option>
                        <option value="journal">üìÑ Jurnal</option>
                        <option value="website">üåê Website</option>
                        <option value="article">üì∞ Artikel</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="author">
                        Nama Penulis <span class="required-star">*</span>
                    </label>
                    <input type="text" id="author" placeholder="Contoh: A. D. PRAYOGA">
                    <div class="field-info">Huruf kapital otomatis untuk penulis</div>
                </div>
                
                <div class="form-group">
                    <label for="title">
                        Judul Karya <span class="required-star">*</span>
                    </label>
                    <input type="text" id="title" placeholder="Judul referensi...">
                    <div class="field-info">Huruf kecil untuk judul</div>
                </div>
                
                <div class="form-group">
                    <label for="year">
                        Tahun Terbit <span class="required-star">*</span>
                    </label>
                    <input type="number" id="year" placeholder="2024" min="1900" max="2100">
                </div>
                
                <div class="form-group">
                    <label for="publisher" class="optional">Penerbit (Opsional)</label>
                    <input type="text" id="publisher" placeholder="Nama penerbit">
                </div>
                
                <div class="form-group">
                    <label for="city" class="optional">Kota Terbit (Opsional)</label>
                    <input type="text" id="city" placeholder="Kota penerbitan">
                </div>
                
                <div class="action-buttons">
                    <button class="btn" onclick="addReference()">
                        + Tambahkan Referensi
                    </button>
                    <button class="btn btn-secondary" onclick="clearForm()">
                        üîÑ Reset Form
                    </button>
                    <button class="btn" onclick="addExample()">
                        üìù Contoh Data
                    </button>
                </div>
                
                <div style="margin-top: 20px; padding: 15px; background: #e8f4fc; border-radius: 8px;">
                    <strong>üìå Format Output:</strong>
                    <ul style="margin-top: 10px; padding-left: 20px; font-size: 0.9rem;">
                        <li><strong>NAMA PENULIS. judul karya. (tahun)</strong></li>
                        <li>Tidak ada penomoran</li>
                        <li>Nama penulis huruf KAPITAL</li>
                        <li>Judul karya huruf kecil</li>
                        <li>Tahun dalam kurung</li>
                    </ul>
                </div>
            </div>
            
            <!-- OUTPUT SECTION -->
            <div class="output-section">
                <h2 style="color: #2c3e50; margin-bottom: 20px;">üìã Daftar Pustaka</h2>
                
                <!-- Kontrol Pemformatan Sederhana -->
                <div class="formatting-controls">
                    <div class="formatting-row">
                        <div class="formatting-group">
                            <label class="formatting-label">Spasi Baris:</label>
                            <input type="number" class="formatting-input" id="lineSpacing" 
                                   min="0.5" max="2" step="0.1" value="0.9" onchange="updateFormatting()">
                        </div>
                        
                        <div class="formatting-group">
                            <label class="formatting-label">Spasi Antar:</label>
                            <input type="number" class="formatting-input" id="refSpacing" 
                                   min="0" max="3" step="0.1" value="1.0" onchange="updateFormatting()">
                        </div>
                        
                        <div class="formatting-group">
                            <label class="formatting-label">Font Size:</label>
                            <select class="formatting-select" id="fontSize" onchange="updateFormatting()">
                                <option value="0.9">Kecil</option>
                                <option value="1.0" selected>Normal</option>
                                <option value="1.1">Sedang</option>
                                <option value="1.2">Besar</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <!-- Selected Format Info -->
                <div style="margin-top: 20px; padding: 15px; background: #fff8e1; border-radius: 8px;">
                    <strong>Format:</strong>
                    <div id="formatInfo" style="margin-top: 10px;">
                        <span id="selectedFormat" style="font-weight: bold; color: #2c3e50;">DAFTAR PUSTAKA</span>
                        <div id="formatDescription" style="font-size: 0.9rem; color: #666; margin-top: 5px;">
                            NAMA PENULIS. judul karya. (tahun)
                        </div>
                    </div>
                </div>
                
                <!-- Output Box -->
                <div style="margin-top: 20px;">
                    <label>Hasil Daftar Pustaka:</label>
                    <div class="output-box" id="output">
                        Tambahkan referensi untuk melihat daftar pustaka...
                    </div>
                </div>
                
                <!-- Output Actions -->
                <div class="action-buttons">
                    <button class="btn btn-success" onclick="generateBibliography()">
                        üîß Generate
                    </button>
                    <button class="btn" onclick="copyToClipboard()">
                        üìã Copy
                    </button>
                    <button class="btn" onclick="downloadAsTxt()">
                        üì• Download
                    </button>
                    <button class="btn btn-danger" onclick="clearAll()">
                        üóëÔ∏è Clear All
                    </button>
                </div>
                
                <!-- References List -->
                <div style="margin-top: 20px;">
                    <label>Daftar Referensi (<span id="refCount2">0</span>):</label>
                    <div id="referencesList" style="max-height: 200px; overflow-y: auto; margin-top: 10px;">
                        <!-- Dynamic content -->
                    </div>
                </div>
                
                <div style="margin-top: 20px; padding: 15px; background: #d4edda; border-radius: 8px;">
                    <strong>‚úÖ Format Sederhana:</strong>
                    <ul style="margin-top: 10px; padding-left: 20px; font-size: 0.9rem;">
                        <li><strong>Tidak ada penomoran</strong> - hanya daftar</li>
                        <li><strong>Nama penulis huruf KAPITAL</strong></li>
                        <li><strong>Judul huruf kecil</strong> (kecuali kata penting)</li>
                        <li><strong>Tahun dalam kurung</strong></li>
                        <li>Urut <strong>alfabet berdasarkan nama penulis</strong></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ===== STATE MANAGEMENT =====
        let references = JSON.parse(localStorage.getItem('bibliography_references')) || [];
        
        // ===== PENGATURAN PEMFORMATAN =====
        let formattingSettings = {
            lineSpacing: 0.9,
            refSpacing: 1.0,
            fontSize: '1.0'
        };
        
        // ===== INITIALIZATION =====
        document.addEventListener('DOMContentLoaded', function() {
            updateStats();
            updateReferencesList();
            
            // Add example data if empty
            if (references.length === 0) {
                addExampleData();
            }
            
            // Load formatting settings from localStorage
            const savedSettings = localStorage.getItem('bibliography_formatting');
            if (savedSettings) {
                formattingSettings = JSON.parse(savedSettings);
                applyFormattingSettings();
            }
            
            // Generate initial bibliography
            generateBibliography();
        });
        
        // ===== FUNGSI UTAMA =====
        function addReference() {
            // Get form values
            const refType = document.getElementById('refType').value;
            let author = document.getElementById('author').value.trim();
            const year = document.getElementById('year').value.trim();
            let title = document.getElementById('title').value.trim();
            const publisher = document.getElementById('publisher').value.trim();
            const city = document.getElementById('city').value.trim();
            
            // Validation
            if (!author || !year || !title) {
                showToast('‚ùå Mohon isi Nama Penulis, Tahun, dan Judul', 'error');
                return;
            }
            
            // Format author to uppercase
            author = author.toUpperCase();
            
            // Format title - keep as is for now
            // title = title.toLowerCase();
            
            // Create reference object
            const reference = {
                id: Date.now(),
                type: refType,
                author: author,
                year: year,
                title: title,
                createdAt: new Date().toISOString()
            };
            
            // Add optional fields only if they have value
            if (publisher) reference.publisher = publisher;
            if (city) reference.city = city;
            
            // Add to references
            references.push(reference);
            
            // Save to localStorage
            saveToLocalStorage();
            
            // Update UI
            clearForm();
            updateReferencesList();
            updateStats();
            
            // Auto-generate bibliography
            generateBibliography();
            
            showToast('‚úÖ Referensi berhasil ditambahkan');
        }
        
        function generateBibliography() {
            if (references.length === 0) {
                document.getElementById('output').textContent = 'Tambahkan referensi untuk melihat daftar pustaka...';
                return;
            }
            
            // Sort references alphabetically by author
            references.sort((a, b) => {
                const authorA = a.author.toLowerCase();
                const authorB = b.author.toLowerCase();
                return authorA.localeCompare(authorB);
            });
            
            // Generate bibliography
            let bibliography = 'DAFTAR PUSTAKA\n\n';
            
            references.forEach(ref => {
                let entry = '';
                
                // Format: AUTHOR. title. (year)
                if (ref.author) entry += `${ref.author}. `;
                if (ref.title) entry += `${formatTitle(ref.title)}. `;
                if (ref.year) entry += `(${ref.year})`;
                
                // Add publisher info if available
                if (ref.publisher) {
                    entry += ` ${ref.publisher}.`;
                    if (ref.city) entry += ` ${ref.city}.`;
                }
                
                bibliography += `${entry}\n`;
            });
            
            // Apply formatting
            bibliography = applyFormatting(bibliography);
            
            // Update output
            document.getElementById('output').innerHTML = bibliography;
            
            showToast('‚úÖ Daftar pustaka berhasil dibuat');
        }
        
        function formatTitle(title) {
            // Convert to lowercase first
            let formatted = title.toLowerCase();
            
            // Capitalize first letter of each word (optional)
            // formatted = formatted.replace(/\b\w/g, char => char.toUpperCase());
            
            return formatted;
        }
        
        function applyFormatting(text) {
            // Split by lines
            const lines = text.split('\n');
            let formattedHTML = '';
            
            lines.forEach((line, index) => {
                if (line.trim() === '') {
                    // Empty line
                    formattedHTML += '<br>';
                } else if (line.includes('DAFTAR PUSTAKA')) {
                    // Header
                    formattedHTML += `<div style="font-weight: bold; font-size: 1.2em; text-align: center; margin-bottom: 1em;">${line}</div>`;
                } else {
                    // Regular bibliography entry
                    // Apply hanging indent
                    formattedHTML += `<div class="bibliography-item hanging-indent" style="line-height: ${formattingSettings.lineSpacing} !important; margin-bottom: ${formattingSettings.refSpacing}em !important; font-size: ${formattingSettings.fontSize}rem !important;">`;
                    
                    // Find author and apply uppercase styling
                    const dotIndex = line.indexOf('.');
                    if (dotIndex > -1) {
                        const author = line.substring(0, dotIndex + 1);
                        const rest = line.substring(dotIndex + 1);
                        formattedHTML += `<span class="capitalize-author">${author}</span>${rest}`;
                    } else {
                        formattedHTML += line;
                    }
                    
                    formattedHTML += '</div>';
                }
            });
            
            return formattedHTML;
        }
        
        function updateFormatting() {
            // Update settings from UI
            formattingSettings.lineSpacing = parseFloat(document.getElementById('lineSpacing').value);
            formattingSettings.refSpacing = parseFloat(document.getElementById('refSpacing').value);
            formattingSettings.fontSize = document.getElementById('fontSize').value;
            
            // Save to localStorage
            localStorage.setItem('bibliography_formatting', JSON.stringify(formattingSettings));
            
            // Re-generate bibliography
            generateBibliography();
        }
        
        function applyFormattingSettings() {
            // Apply settings to UI controls
            document.getElementById('lineSpacing').value = formattingSettings.lineSpacing;
            document.getElementById('refSpacing').value = formattingSettings.refSpacing;
            document.getElementById('fontSize').value = formattingSettings.fontSize;
        }
        
        // ===== FUNGSI BANTU =====
        function clearForm() {
            document.getElementById('author').value = '';
            document.getElementById('year').value = '';
            document.getElementById('title').value = '';
            document.getElementById('publisher').value = '';
            document.getElementById('city').value = '';
        }
        
        function removeReference(id) {
            if (confirm('Hapus referensi ini?')) {
                references = references.filter(ref => ref.id !== id);
                saveToLocalStorage();
                updateReferencesList();
                updateStats();
                generateBibliography();
                showToast('üóëÔ∏è Referensi dihapus');
            }
        }
        
        function clearAll() {
            if (references.length === 0) {
                showToast('Tidak ada referensi untuk dihapus');
                return;
            }
            
            if (confirm(`Hapus semua ${references.length} referensi?`)) {
                references = [];
                saveToLocalStorage();
                updateReferencesList();
                updateStats();
                document.getElementById('output').textContent = 'Tambahkan referensi untuk melihat daftar pustaka...';
                showToast('üßπ Semua referensi dihapus');
            }
        }
        
        function saveToLocalStorage() {
            localStorage.setItem('bibliography_references', JSON.stringify(references));
        }
        
        function updateReferencesList() {
            const container = document.getElementById('referencesList');
            const count = references.length;
            document.getElementById('refCount').textContent = count;
            document.getElementById('refCount2').textContent = count;
            
            if (count === 0) {
                container.innerHTML = '<div style="text-align: center; padding: 20px; color: #999;">Belum ada referensi...</div>';
                return;
            }
            
            let html = '<div style="display: flex; flex-direction: column; gap: 10px;">';
            
            references.forEach((ref, index) => {
                const typeIcon = ref.type === 'journal' ? 'üìÑ' : 
                                ref.type === 'book' ? 'üìö' : 
                                ref.type === 'website' ? 'üåê' : 'üì∞';
                
                html += `
                    <div class="reference-item">
                        <div style="display: flex; justify-content: space-between; align-items: start;">
                            <div style="flex: 1;">
                                <strong style="font-size: 0.9rem;">${typeIcon} ${ref.author}</strong><br>
                                <span style="font-size: 0.85rem; color: #666;">${ref.title}</span><br>
                                <small style="color: #28a745;">(${ref.year})</small>
                            </div>
                            <button onclick="removeReference(${ref.id})" 
                                    style="background: none; border: none; color: #dc3545; cursor: pointer; font-size: 1.2rem;">
                                √ó
                            </button>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            container.innerHTML = html;
        }
        
        function updateStats() {
            const count = references.length;
            document.getElementById('refCount').textContent = count;
            
            let completeCount = 0;
            references.forEach(ref => {
                if (ref.author && ref.year && ref.title) {
                    completeCount++;
                }
            });
            document.getElementById('completeCount').textContent = completeCount;
        }
        
        async function copyToClipboard() {
            const outputDiv = document.getElementById('output');
            const text = outputDiv.textContent;
            
            if (!text || text.includes('Tambahkan referensi')) {
                showToast('‚ùå Tidak ada teks untuk disalin', 'error');
                return;
            }
            
            try {
                await navigator.clipboard.writeText(text);
                showToast('‚úÖ Berhasil disalin ke clipboard');
            } catch (err) {
                console.error('Copy failed:', err);
                
                // Fallback method
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                
                showToast('‚úÖ Berhasil disalin (fallback)');
            }
        }
        
        function downloadAsTxt() {
            const text = document.getElementById('output').textContent;
            
            if (!text || text.includes('Tambahkan referensi')) {
                showToast('‚ùå Tidak ada data untuk didownload', 'error');
                return;
            }
            
            const blob = new Blob([text], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `daftar-pustaka-${new Date().toISOString().split('T')[0]}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showToast('‚úÖ File berhasil didownload');
        }
        
        function addExample() {
            const examples = [
                {
                    type: 'book',
                    author: 'A. D. PRAYOGA',
                    year: '2023',
                    title: 'manusia ikan adalah mitos'
                },
                {
                    type: 'book',
                    author: 'A. D. PRAYOGA',
                    year: '2020',
                    title: 'bumi langit'
                },
                {
                    type: 'article',
                    author: 'ANGGA DWI PRAYOGA',
                    year: '2024',
                    title: 'manusia ikan beraklak'
                }
            ];
            
            examples.forEach(example => {
                references.push({
                    id: Date.now() + Math.random(),
                    ...example,
                    createdAt: new Date().toISOString()
                });
            });
            
            saveToLocalStorage();
            updateReferencesList();
            updateStats();
            generateBibliography();
            showToast('‚úÖ Contoh data ditambahkan');
        }
        
        function addExampleData() {
            // Initial example data
            if (references.length === 0) {
                addExample();
            }
        }
        
        function showToast(message, type = 'info') {
            const existingToast = document.querySelector('.toast');
            if (existingToast) existingToast.remove();
            
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.textContent = message;
            toast.style.cssText = `
                position: fixed;
                bottom: 20px;
                right: 20px;
                background: ${type === 'error' ? '#dc3545' : '#28a745'};
                color: white;
                padding: 12px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 1000;
                animation: slideIn 0.3s ease;
            `;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }
    </script>
</body>
</html>
